<div class="favicon-container">
  <div class="header">
    <h1>Favicon Generator</h1>
    <p>Create professional favicons for your website with text or images</p>
  </div>

  <div class="mode-selector">
    <button [class.active]="mode() === 'text'" (click)="mode.set('text'); generatePreview()">
      <span class="icon">T</span> Text Favicon
    </button>
    <button [class.active]="mode() === 'emoji'" (click)="mode.set('emoji'); generatePreview()">
      <span class="icon">üòÄ</span> Emoji Favicon
    </button>
    <button [class.active]="mode() === 'image'" (click)="mode.set('image'); generatePreview()">
      <span class="icon">üñºÔ∏è</span> Image Favicon
    </button>
  </div>

  @if (mode() === 'text') {
    <div class="text-mode">
      <div class="input-section">
        <div class="form-group">
          <label for="text">Text (max 2 characters)</label>
          <input
            id="text"
            type="text"
            [(ngModel)]="text"
            (ngModelChange)="generatePreview()"
            maxlength="2"
            placeholder="AI"
          />
        </div>

        <div class="form-group">
          <label for="fontFamily">Font Style</label>
          <select id="fontFamily" [(ngModel)]="fontFamily" (ngModelChange)="generatePreview()">
            @for (font of fontFamilies; track font.value) {
              <option [value]="font.value">{{ font.name }}</option>
            }
          </select>
        </div>

        <div class="form-group">
          <label>
            <input
              type="checkbox"
              [(ngModel)]="combineEmojiText"
              (ngModelChange)="generatePreview()"
            />
            Combine with emoji
          </label>
        </div>

        @if (combineEmojiText()) {
          <div class="form-group">
            <label for="emojiSelect">Select Emoji</label>
            <input
              id="emojiSelect"
              type="text"
              [(ngModel)]="emoji"
              (ngModelChange)="generatePreview()"
              maxlength="2"
              placeholder="üöÄ"
              class="emoji-input-small"
            />
          </div>

          <div class="form-group">
            <!-- eslint-disable-next-line @angular-eslint/template/label-has-associated-control -->
            <label id="position-label">Position & Layout</label>
            <div class="radio-group" role="radiogroup" aria-labelledby="position-label">
              <label>
                <input
                  type="radio"
                  name="position"
                  [checked]="emojiPosition() === 'top'"
                  (change)="emojiPosition.set('top'); generatePreview()"
                />
                üîº Emoji Top
              </label>
              <label>
                <input
                  type="radio"
                  name="position"
                  [checked]="emojiPosition() === 'bottom'"
                  (change)="emojiPosition.set('bottom'); generatePreview()"
                />
                üîΩ Emoji Bottom
              </label>
              <label>
                <input
                  type="radio"
                  name="position"
                  [checked]="emojiPosition() === 'left'"
                  (change)="emojiPosition.set('left'); generatePreview()"
                />
                ‚óÄÔ∏è Emoji Left
              </label>
              <label>
                <input
                  type="radio"
                  name="position"
                  [checked]="emojiPosition() === 'right'"
                  (change)="emojiPosition.set('right'); generatePreview()"
                />
                ‚ñ∂Ô∏è Emoji Right
              </label>
              <label>
                <input
                  type="radio"
                  name="position"
                  [checked]="emojiPosition() === 'text-over-emoji'"
                  (change)="emojiPosition.set('text-over-emoji'); generatePreview()"
                />
                üìù Text Over Emoji
              </label>
              <label>
                <input
                  type="radio"
                  name="position"
                  [checked]="emojiPosition() === 'emoji-over-text'"
                  (change)="emojiPosition.set('emoji-over-text'); generatePreview()"
                />
                üé® Emoji Over Text
              </label>
            </div>
          </div>
        }

        <div class="form-group">
          <label for="template-selector">Template</label>
          <input type="hidden" id="template-selector" [value]="selectedTemplate()" />
          <div class="template-grid" role="group" aria-labelledby="template-label">
            @for (template of templates; track template.id) {
              <button
                class="template-btn"
                [class.active]="selectedTemplate() === template.id"
                (click)="selectedTemplate.set(template.id); generatePreview()"
                [style.background]="
                  template.pattern === 'gradient' && template.gradientEnd
                    ? 'linear-gradient(135deg, ' +
                      template.bgColor +
                      ', ' +
                      template.gradientEnd +
                      ')'
                    : template.bgColor
                "
                [style.color]="template.textColor"
              >
                <span class="template-name">{{ template.name }}</span>
                @if (
                  template.name.toLowerCase().includes('green') ||
                  template.name.toLowerCase().includes('emerald') ||
                  template.name.toLowerCase().includes('mint') ||
                  template.name.toLowerCase().includes('forest') ||
                  template.name.toLowerCase().includes('lime') ||
                  template.name.toLowerCase().includes('teal') ||
                  template.name.toLowerCase().includes('sage')
                ) {
                  <span class="green-badge">üåø</span>
                }
              </button>
            }
          </div>
        </div>

        <div class="form-group">
          <label>
            <input
              type="checkbox"
              [(ngModel)]="useTransparent"
              (ngModelChange)="generatePreview()"
            />
            Use transparent background
          </label>
        </div>

        <div class="form-group">
          <label>
            <input
              type="checkbox"
              [(ngModel)]="useCustomTextColor"
              (ngModelChange)="generatePreview()"
            />
            Custom text color
          </label>
        </div>

        @if (useCustomTextColor()) {
          <div class="form-group">
            <label for="customTextColor">Text Color</label>
            <div class="color-picker-group">
              <input
                id="customTextColor"
                type="color"
                [(ngModel)]="customTextColor"
                (ngModelChange)="generatePreview()"
              />
              <input
                type="text"
                [(ngModel)]="customTextColor"
                (ngModelChange)="generatePreview()"
                placeholder="#ffffff"
                class="color-input"
              />
            </div>
          </div>
        }

        <div class="form-group">
          <label for="size">Favicon Size</label>
          <select id="size" [(ngModel)]="size">
            <option [value]="16">16x16 (Standard)</option>
            <option [value]="32">32x32 (Recommended)</option>
            <option [value]="48">48x48 (High-Res)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="format">Download Format</label>
          <select id="format" [(ngModel)]="downloadFormat">
            <option value="png">PNG (Recommended)</option>
            <option value="ico">ICO (Classic)</option>
          </select>
        </div>
      </div>
    </div>
  }

  @if (mode() === 'emoji') {
    <div class="emoji-mode">
      <div class="input-section">
        <div class="form-group">
          <label for="emojiInput">Selected Emoji</label>
          <input
            id="emojiInput"
            type="text"
            [(ngModel)]="emoji"
            (ngModelChange)="generatePreview()"
            maxlength="2"
            placeholder="üöÄ"
            class="emoji-input"
          />
        </div>

        <div class="form-group">
          <label for="popularEmojis"
            >Popular Emojis
            <a
              href="https://getemoji.com/"
              target="_blank"
              rel="noopener noreferrer"
              class="emoji-link"
              >(More at getemoji.com)</a
            >
          </label>
          <input type="hidden" id="popularEmojis" [value]="emoji()" />
          <div class="emoji-grid">
            @for (emojiItem of popularEmojis; track emojiItem) {
              <button
                class="emoji-btn"
                [class.active]="emoji() === emojiItem"
                (click)="emoji.set(emojiItem); generatePreview()"
                type="button"
              >
                {{ emojiItem }}
              </button>
            }
          </div>
        </div>

        <div class="form-group">
          <label for="emojiTemplate">Template</label>
          <input type="hidden" id="emojiTemplate" [value]="selectedTemplate()" />
          <div class="template-grid" role="group" aria-labelledby="emojiTemplate">
            @for (template of templates; track template.id) {
              <button
                class="template-btn"
                [class.active]="selectedTemplate() === template.id"
                (click)="selectedTemplate.set(template.id); generatePreview()"
                [style.background]="
                  template.pattern === 'gradient' && template.gradientEnd
                    ? 'linear-gradient(135deg, ' +
                      template.bgColor +
                      ', ' +
                      template.gradientEnd +
                      ')'
                    : template.bgColor
                "
                [style.color]="template.textColor"
              >
                <span class="template-name">{{ template.name }}</span>
                @if (
                  template.name.toLowerCase().includes('green') ||
                  template.name.toLowerCase().includes('emerald') ||
                  template.name.toLowerCase().includes('mint') ||
                  template.name.toLowerCase().includes('forest') ||
                  template.name.toLowerCase().includes('lime') ||
                  template.name.toLowerCase().includes('teal') ||
                  template.name.toLowerCase().includes('sage')
                ) {
                  <span class="green-badge">üåø</span>
                }
              </button>
            }
          </div>
        </div>

        <div class="form-group">
          <label>
            <input
              type="checkbox"
              [(ngModel)]="useTransparent"
              (ngModelChange)="generatePreview()"
            />
            Use transparent background
          </label>
        </div>

        <div class="form-group">
          <label for="emojiSize">Favicon Size</label>
          <select id="emojiSize" [(ngModel)]="size">
            <option [value]="16">16x16 (Standard)</option>
            <option [value]="32">32x32 (Recommended)</option>
            <option [value]="48">48x48 (High-Res)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="emojiFormat">Download Format</label>
          <select id="emojiFormat" [(ngModel)]="downloadFormat">
            <option value="png">PNG (Recommended)</option>
            <option value="ico">ICO (Classic)</option>
          </select>
        </div>
      </div>
    </div>
  }

  @if (mode() === 'image') {
    <div class="image-mode">
      <div class="upload-section">
        @if (!uploadedImage()) {
          <div
            class="upload-area"
            (click)="fileInput.click()"
            (keyup.enter)="fileInput.click()"
            (keyup.space)="fileInput.click()"
            tabindex="0"
            role="button"
            aria-label="Upload image file"
          >
            <div class="upload-icon">üìÅ</div>
            <p>Click to upload an image</p>
            <p class="upload-hint">PNG, JPG, SVG supported</p>
            <input
              #fileInput
              type="file"
              accept="image/*"
              (change)="onFileSelected($event)"
              style="display: none"
            />
          </div>
        } @else {
          <div class="uploaded-preview">
            <img [src]="uploadedImage()" alt="Uploaded image" />
            <button class="remove-btn" (click)="removeImage()">‚úï Remove</button>
          </div>
        }
      </div>

      @if (uploadedImage()) {
        <div class="form-group">
          <label for="imageSize">Favicon Size</label>
          <select id="imageSize" [(ngModel)]="size">
            <option [value]="16">16x16 (Standard)</option>
            <option [value]="32">32x32 (Recommended)</option>
            <option [value]="48">48x48 (High-Res)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="imageFormat">Download Format</label>
          <select id="imageFormat" [(ngModel)]="downloadFormat">
            <option value="png">PNG (Recommended)</option>
            <option value="ico">ICO (Classic)</option>
          </select>
        </div>
      }
    </div>
  }

  <div class="preview-section">
    <h3>Preview</h3>
    <div class="preview-container">
      <canvas #previewCanvas class="preview-canvas"></canvas>
      <p class="preview-note">Actual size will be {{ size() }}x{{ size() }} pixels</p>
    </div>
  </div>

  <div class="action-buttons">
    <button
      class="download-btn primary"
      (click)="downloadFavicon()"
      [disabled]="
        (mode() === 'text' && !text()) ||
        (mode() === 'emoji' && !emoji()) ||
        (mode() === 'image' && !uploadedImage())
      "
    >
      ‚¨áÔ∏è Download Favicon ({{ size() }}x{{ size() }})
    </button>
    <button
      class="download-btn secondary"
      (click)="downloadAllSizes()"
      [disabled]="
        (mode() === 'text' && !text()) ||
        (mode() === 'emoji' && !emoji()) ||
        (mode() === 'image' && !uploadedImage())
      "
    >
      ‚¨áÔ∏è Download All Sizes (16, 32, 48)
    </button>
  </div>

  <div class="info-section">
    <h3>About Favicons</h3>
    <div class="info-content">
      <div class="info-card">
        <h4>üìè Standard Sizes</h4>
        <ul>
          <li><strong>16x16:</strong> Classic browser tab icon</li>
          <li><strong>32x32:</strong> Most common, recommended for modern browsers</li>
          <li><strong>48x48:</strong> High-resolution displays and bookmarks</li>
        </ul>
      </div>

      <div class="info-card">
        <h4>üé® Design Tips</h4>
        <ul>
          <li>Keep designs simple and recognizable at small sizes</li>
          <li>Use high contrast between text and background</li>
          <li>Limit to 1-2 characters for text favicons</li>
          <li>Emojis work great for modern, playful brands</li>
          <li><strong>Combine emoji + text</strong> for unique, expressive favicons</li>
          <li>Try different positions: Top, Bottom, Left, Right</li>
          <li><strong>Text Over Emoji:</strong> Big emoji background with text overlay</li>
          <li><strong>Emoji Over Text:</strong> Large text with emoji accent at bottom-right</li>
          <li>Try different font styles for unique looks</li>
          <li>Test on both light and dark browser themes</li>
        </ul>
      </div>

      <div class="info-card">
        <h4>üé≠ Font Styles & Emojis</h4>
        <ul>
          <li><strong>12 Font Styles:</strong> From elegant serifs to playful cursive</li>
          <li><strong>80 Popular Emojis:</strong> Quick access to commonly used emojis</li>
          <li><strong>Emoji + Text Combo:</strong> Combine both for unique designs</li>
          <li><strong>6 Layout Options:</strong> Top, Bottom, Left, Right, Over, Under</li>
          <li><strong>Text Over Emoji:</strong> Big emoji (70%) with text overlay</li>
          <li><strong>Emoji Over Text:</strong> Large text (55%) with emoji accent (30%)</li>
          <li><strong>Custom Text Color:</strong> Perfect for transparent backgrounds</li>
          <li><strong>Brush Script:</strong> Cursive, handwritten style</li>
          <li><strong>Impact:</strong> Strong, bold headlines</li>
          <li><strong>Georgia:</strong> Classic, elegant serif</li>
        </ul>
      </div>

      <div class="info-card">
        <h4>üíª How to Use</h4>
        <ul>
          <li>Place <code>favicon.ico</code> in your website root directory</li>
          <li>Or add to HTML: <code>&lt;link rel="icon" href="/favicon.png"&gt;</code></li>
          <li>Modern browsers support PNG, ICO, and SVG formats</li>
          <li>Use multiple sizes for better quality across devices</li>
        </ul>
      </div>

      <div class="info-card green-themed">
        <h4>üåø Green Templates</h4>
        <p>
          We offer 10 green-themed templates perfect for eco-friendly, fresh, and nature-inspired
          brands:
        </p>
        <ul>
          <li><strong>Green Gradient</strong> - Classic emerald gradient</li>
          <li><strong>Forest Green</strong> - Deep, professional green</li>
          <li><strong>Mint Fresh</strong> - Light, modern mint color</li>
          <li><strong>Teal Ocean</strong> - Blue-green ocean vibes</li>
          <li><strong>Sage Green</strong> - Soft, elegant sage tone</li>
        </ul>
      </div>
    </div>
  </div>
</div>
